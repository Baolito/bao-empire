<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bao's Dumpling Empire</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Bao's Empire">
    
    <link rel="icon" href="https://fav.farm/ðŸ¥Ÿ" />
    <link rel="apple-touch-icon" href="https://fav.farm/ðŸ¥Ÿ" />
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bao: {
                            sky: '#f0f9ff',
                            navy: '#0c4a6e',
                            blue: '#38bdf8',
                            darkBlue: '#0369a1',
                        }
                    },
                    fontFamily: {
                        sans: ['Quicksand', 'sans-serif'],
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-12px)' },
                        }
                    },
                    animation: {
                        float: 'float 3.5s ease-in-out infinite',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #f0f9ff;
            color: #0c4a6e;
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
        }
        .main-card {
            box-shadow: 0 20px 50px -12px rgba(12, 74, 110, 0.12);
        }
        .progress-glow {
            box-shadow: 0 0 12px rgba(56, 189, 248, 0.4);
        }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const BASE_ETF_PRICE = 129.54;
        const AFFIRMATIONS = [
            "Patience is your best investment.",
            "Steam ahead with long-term goals!",
            "Every dumpling counts towards your empire.",
            "The market breathes, just like a fresh bao.",
            "Consistency is the secret sauce.",
            "Warm steam hugs for your portfolio today.",
            "A little dough today, a whole empire tomorrow."
        ];

        // --- SVGs ---
        const BlueFireIcon = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M12 2C12 2 15 5 15 9C15 11 14 13 12 15C10 13 9 11 9 9C9 5 12 2 12 2Z" fill="#38bdf8" />
                <path d="M12 6C12 6 17 11 17 16C17 19.3137 14.3137 22 11 22C7.68629 22 5 19.3137 5 16C5 11 12 6 12 6Z" fill="#0ea5e9" />
                <path d="M12 10C12 10 14 13 14 16C14 17.6569 12.6569 19 11 19C9.34315 19 8 17.6569 8 16C8 13 12 10 12 10Z" fill="#7dd3fc" />
            </svg>
        );

        const BlueGemIcon = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M12 2L20 8L12 22L4 8L12 2Z" fill="#0284c7" />
                <path d="M12 2L16 8L12 14L8 8L12 2Z" fill="#7dd3fc" />
                <path d="M12 14L20 8L12 22L4 8L12 14Z" fill="#0ea5e9" />
            </svg>
        );

        const BaoMascot = ({ mood }) => {
            const outline = "#0c4a6e";
            return (
                <div className="relative w-44 h-44 animate-float flex items-center justify-center">
                    <div className="absolute bottom-6 w-28 h-3 bg-bao-navy/5 rounded-[100%] blur-md"></div>
                    <svg width="150" height="130" viewBox="0 0 140 120" fill="none">
                        <path d="M10 90C10 50 30 20 70 20C110 20 130 50 130 90C130 110 110 115 70 115C30 115 10 110 10 90Z" fill="white" stroke={outline} strokeWidth="5" />
                        <path d="M55 22C60 12 80 12 85 22" stroke={outline} strokeWidth="3" strokeLinecap="round" />
                        <path d="M70 20V12" stroke={outline} strokeWidth="3" strokeLinecap="round" />
                        <g className="transition-all duration-300">
                            {mood === 'Happy' && (
                                <g>
                                    <path d="M45 70C45 70 52 76 60 70" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                    <path d="M80 70C80 70 88 76 95 70" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                    <path d="M60 92C65 98 75 98 80 92" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                </g>
                            )}
                            {mood === 'Excited' && (
                                <g>
                                    <circle cx="55" cy="70" r="6" fill={outline} />
                                    <circle cx="85" cy="70" r="6" fill={outline} />
                                    <path d="M60 88C60 88 70 104 80 88" fill="#F472B6" />
                                    <path d="M60 88C60 88 70 104 80 88L60 88Z" stroke={outline} strokeWidth="3" />
                                </g>
                            )}
                            {mood === 'Sad' && (
                                <g>
                                    <path d="M45 75C45 75 52 69 60 75" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                    <path d="M80 75C80 75 88 69 95 75" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                    <path d="M65 95C70 90 75 90 80 95" stroke={outline} strokeWidth="4" strokeLinecap="round" />
                                </g>
                            )}
                            {mood === 'Thinking' && (
                                <g>
                                    <circle cx="55" cy="72" r="4" fill={outline} />
                                    <circle cx="85" cy="72" r="4" fill={outline} />
                                    <rect x="62" y="90" width="16" height="4" rx="2" fill={outline} />
                                </g>
                            )}
                        </g>
                        <circle cx="32" cy="85" r="10" fill="#FFD1D1" opacity="0.6" />
                        <circle cx="108" cy="85" r="10" fill="#FFD1D1" opacity="0.6" />
                    </svg>
                </div>
            );
        };

        const App = () => {
            const [userData, setUserData] = useState(() => {
                try {
                    const saved = localStorage.getItem('bao_empire_final_v1');
                    return saved ? JSON.parse(saved) : { shares: 0, streak: 0, lastVisit: null };
                } catch {
                    return { shares: 0, streak: 0, lastVisit: null };
                }
            });

            const [currentPrice, setCurrentPrice] = useState(BASE_ETF_PRICE);
            const [mood, setMood] = useState('Happy');
            const [status, setStatus] = useState(null);

            const totalValue = userData.shares * currentPrice;
            const gems = Math.floor(totalValue / 100);
            const nextMilestone = Math.ceil((totalValue + 0.1) / 1000) * 1000 || 1000;
            const progress = Math.min(Math.max(((totalValue - (nextMilestone - 1000)) / 1000) * 100, 0), 100);

            const affirmation = useMemo(() => {
                const day = Math.floor(Date.now() / 86400000);
                return AFFIRMATIONS[day % AFFIRMATIONS.length];
            }, []);

            useEffect(() => {
                try {
                    localStorage.setItem('bao_empire_final_v1', JSON.stringify(userData));
                } catch (e) { console.warn("Storage restricted"); }
            }, [userData]);

            useEffect(() => {
                const today = new Date().toDateString();
                const yesterday = new Date(Date.now() - 86400000).toDateString();
                if (userData.lastVisit !== today) {
                    setUserData(prev => ({
                        ...prev,
                        streak: prev.lastVisit === yesterday ? prev.streak + 1 : 1,
                        lastVisit: today
                    }));
                }
            }, []);

            const visitBao = () => {
                setMood('Thinking');
                setTimeout(() => {
                    const change = (Math.random() - 0.45) * 0.012;
                    const newPrice = currentPrice * (1 + change);
                    setStatus(newPrice > currentPrice ? 'up' : 'down');
                    setCurrentPrice(newPrice);
                    setMood(newPrice > currentPrice ? 'Excited' : 'Sad');
                    setTimeout(() => {
                        setMood('Happy');
                        setStatus(null);
                    }, 2000);
                }, 800);
            };

            const adjustShares = (val) => {
                setUserData(prev => ({ ...prev, shares: Math.max(0, prev.shares + val) }));
            };

            return (
                <div className="w-full max-w-sm p-4 flex flex-col items-center">
                    <div className="bg-white rounded-[3rem] main-card border border-white w-full overflow-hidden transition-all duration-500 ring-1 ring-bao-sky">
                        
                        <div className="flex justify-between items-center p-8 pb-2">
                            <div className="flex items-center space-x-2 bg-bao-sky/50 px-4 py-2 rounded-full border border-blue-50">
                                <BlueFireIcon />
                                <span className="font-bold text-bao-navy text-lg">{userData.streak}</span>
                            </div>
                            <div className="flex items-center space-x-2 bg-bao-sky/50 px-4 py-2 rounded-full border border-blue-50">
                                <BlueGemIcon />
                                <span className="font-bold text-bao-navy text-lg">{gems}</span>
                            </div>
                        </div>

                        <div className="flex flex-col items-center py-2">
                            <BaoMascot mood={mood} />
                            <h1 className="text-2xl font-black text-bao-navy tracking-tight -mt-4">Bao's Empire</h1>
                            <span className="text-[10px] font-black uppercase tracking-[0.3em] opacity-30 mt-1">VWCE Tracking</span>
                        </div>

                        <div className="px-10 space-y-6">
                            <div className="text-center">
                                <div className={`text-4xl font-black tabular-nums transition-colors duration-500 ${status === 'up' ? 'text-green-500' : status === 'down' ? 'text-rose-500' : 'text-bao-navy'}`}>
                                    â‚¬{totalValue.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                </div>
                                <div className="text-[10px] font-extrabold text-bao-navy/40 uppercase tracking-widest mt-2">
                                    Price: â‚¬{currentPrice.toFixed(2)}
                                </div>
                            </div>

                            <div className="space-y-2.5">
                                <div className="flex justify-between text-[10px] font-black uppercase tracking-widest text-bao-navy/20 px-1">
                                    <span>â‚¬{(nextMilestone - 1000).toLocaleString()}</span>
                                    <span>Goal: â‚¬{nextMilestone.toLocaleString()}</span>
                                </div>
                                <div className="h-4 w-full bg-bao-sky/40 rounded-full overflow-hidden border border-bao-sky relative p-0.5">
                                    <div 
                                        className="h-full bg-gradient-to-r from-bao-blue to-bao-darkBlue transition-all duration-1000 rounded-full progress-glow"
                                        style={{ width: `${progress}%` }}
                                    />
                                </div>
                            </div>
                        </div>

                        <div className="p-10 space-y-6">
                            <div className="flex items-center justify-between bg-bao-sky/20 p-2 rounded-[2.5rem] border border-bao-sky/40 shadow-inner">
                                <button onClick={() => adjustShares(-1)} className="w-12 h-12 flex items-center justify-center rounded-2xl bg-white text-bao-navy text-2xl font-bold shadow-sm active:scale-90">-</button>
                                <div className="flex flex-col items-center">
                                    <span className="text-2xl font-black text-bao-navy leading-none">{userData.shares}</span>
                                    <span className="text-[10px] uppercase font-black text-bao-navy/30 tracking-widest mt-1">Units</span>
                                </div>
                                <button onClick={() => adjustShares(1)} className="w-12 h-12 flex items-center justify-center rounded-2xl bg-bao-blue text-white text-2xl font-bold shadow-md active:scale-90">+</button>
                            </div>

                            <button 
                                onClick={visitBao}
                                disabled={mood === 'Thinking'}
                                className="w-full bg-bao-navy text-white py-4 rounded-[2rem] font-bold text-lg shadow-lg active:scale-[0.98] transition-all disabled:opacity-50"
                            >
                                {mood === 'Thinking' ? 'Connecting...' : 'Visit Bao'}
                            </button>
                        </div>

                        <div className="bg-bao-sky/30 py-6 px-10 border-t border-bao-sky/20 text-center">
                            <p className="text-[11px] italic text-bao-navy/40 font-bold leading-relaxed px-2">
                                "{affirmation}"
                            </p>
                        </div>
                    </div>
                    
                    <footer className="mt-8 text-[10px] uppercase tracking-[0.5em] font-black text-bao-navy/10">
                        Bao Widget v4.0
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
